Данный скрипт работает только с установленным модулями для работы с БД.
Имеется несколько сетевых ресурсов. В каждом сетевом ресурсе находятся личные папки сотрудников (где имя папки равно УЗ пользователя в AD), т.е. каждый сотрудник имеет свой личный сетевой ресурс для хранения данных. Доступ к данной шаре имеет сам сотрудник, а также доступ только на чтение может иметь его руководитель, руководитель руководителя и т.д.  Данный скрипт проверяет корректность проставленных доступов. В начале проверки собирается инфа о том, кто вообще имеет доступ к данной шаре. Затем отдельной фукнцией происходит поиск цепочки руководителей данного сотрудника с сохранением в отдельный массив. Затем значения данного массива сравниваются со значениями тех кто имеет доступ на шару пользователя. Если тот кто имеет доступ не входит в список руководителей - доступ сразу снимается. Если входит в список, т.е. является руководителем, то проверяется какой тип доступа проставлен. Если тип доступа не только на чтение, то доступ для данного руководителя редактируется на доступ на чтение. И так в цикле проверяются шары всех сотрудников.
=====================================================================================================================================